/* PureMVC AS2 FlashLite Demo - Balloonatroid Copyright (c) 2007, 2008 by Cliff Hall <clifford.hall@puremvc.org> and  Chandima Cumaranatunge <chandima.cumaranatunge@puremvc.org> Your reuse is governed by the Creative Commons Attribution 3.0 License */import balloonatroid.interfaces.IState;import balloonatroid.interfaces.IStateMachine;import balloonatroid.GameFacade;import balloonatroid.model.VolleyProxy;/** * The Volley RECOVER state. * In recovery mode after it has gone off screen. */class balloonatroid.model.volley.RecoverState implements IState{	/** Cannonical name of the State. */	public static var NAME:String = 'RECOVER';		/** Singleton state object instance. */	private static var instance : IState;		/** Message Constants. */	private var SINGLETON_MSG	: String = "IState Singleton already constructed!";	/**	 * Constructor. 	 * 	 * <P>	 * This <code>IState</code> implementation is a Singleton, 	 * so you should not call the constructor 	 * directly, but instead call the static Singleton 	 * Factory method <code>IState.getInstance()</code>	 * 	 * @throws Error if Singleton instance has already been constructed.	 * 	 */	public function RecoverState()	{		if (instance != null) throw Error(SINGLETON_MSG);		instance = this;	}		/**	 * <code>Model</code> Singleton Factory method.	 * 	 * @return the Singleton instance.	 */	public static function getInstance() : IState 	{		if (instance == null) instance = new RecoverState( );		return instance;	}		/**	 * The logic to be executed when the state is entered.	 *	 * Positions the volley balloon off the bottom of the screen.	 * Sets the target location to the recovered position (bottom center of the screen).	 *	 * @param sm The {@link balloonatroid.model.VolleyProxy VolleyProxy} that delegates this state object.	 */	public function enter(sm:IStateMachine):Void {		// place the volley lower than the bottom of the stage		VolleyProxy(sm).setPosition( VolleyProxy(sm).sprite._x , 										VolleyProxy(sm).gameProxy.gameHeight + 25 );		// set the target position		VolleyProxy(sm).setTarget( VolleyProxy(sm).gameProxy.gameWidth / 2 , 										VolleyProxy(sm).gameProxy.gameHeight - 25 );	}		/**	 * The logic to be executed when the state is updated.	 *	 * Moves to the target location using an {@link balloonatroid.model.AbstractSpriteProxy#seekTarget() seek} algorithm.	 * Moves to the target location using an {@link balloonatroid.model.AbstractSpriteProxy#arriveAtTarget() arrive} algorithm if close to target.	 * Broadcasts {@link balloonatroid.GameFacade#GO_VOLLEY_DORMANT GO_VOLLEY_DORMANT} notification if extremely close	 * to target to transition to the DORMANT state.	 *	 * @param sm The {@link balloonatroid.model.VolleyProxy VolleyProxy} that delegates this state object.	 */	public function execute(sm:IStateMachine):Void {		var dist:Number = VolleyProxy(sm).distanceToTarget();		if ( dist < 5 ) 		{			sm.sendNotification( GameFacade.GO_VOLLEY_DORMANT ); // go to the volley dormant state		} 		else if ( dist < 15 ) 		{			VolleyProxy(sm).arriveAtTarget();		} 		else 		{			VolleyProxy(sm).seekTarget();		}	}		public function exit(sm:IStateMachine):Void {	}		/**	 * State Name.	 * Useful for debugging.	 * @return The canonical name of the state.	 */	public function toString() : String 	{		return NAME;	}	}